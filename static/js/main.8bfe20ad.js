(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=require("react");var s=e.n(t);const n=require("react-dom/client");var o=e.n(n);const a=require("react/jsx-runtime");const l=function(){const[e,t]=s().useState([]),[n,o]=s().useState([]),[l,r]=s().useState([]),[c,i]=s().useState([]),[d,u]=s().useState([]),[m,h]=s().useState((()=>{const e=localStorage.getItem("removedCourses");return e?JSON.parse(e):[]})),[p,g]=s().useState([]),[x,v]=s().useState([]),[j,f]=s().useState((()=>{const e=localStorage.getItem("unsortedToDo");return e?JSON.parse(e):[]})),[N,y]=s().useState((()=>{const e=localStorage.getItem("addedToDo");return e?JSON.parse(e):[]})),[S,D]=s().useState((()=>{const e=localStorage.getItem("completedAssignments");return e?JSON.parse(e):[]})),[b,k]=s().useState([]),[C,w]=s().useState([]),[I,A]=s().useState([]),[_,E]=s().useState(""),[T,O]=s().useState((()=>{const e=localStorage.getItem("toDoExtent");return null!==e?e:"7"})),[J,M]=s().useState((()=>JSON.parse(localStorage.getItem("key")))),[B,L]=s().useState((()=>{const e=JSON.parse(localStorage.getItem("validKey"));return null!=e&&e})),[P,F]=s().useState(!0);function R(e){for(let t=0;t<n.length;t++)if(e==n[t].course_id)return n[t].grades.current_score}function q(e){if(e){const t=new Date(e),s=t.getUTCDate(),n=t.getUTCMonth()+1,o=t.getUTCFullYear(),a=n<10?"0"+n:n;return"".concat(s<10?"0"+s:s,"/").concat(a,"/").concat(o)}return null}function U(e){if(!e)return null;const t=e.split("/"),s=new Date(t[2],t[1]-1,t[0]),n=new Date;n.setHours(0,0,0,0),s.setHours(0,0,0,0);const o=Math.round((s-n)/864e5);if(0==o)return["Today",o];if(1==o)return["Tomorrow",o];{const e=s.toLocaleDateString(void 0,{month:"short"}),t=s.getDate();return["".concat(e," ").concat(t),o]}}function z(e,t){if(e.length<=t)return e;const s=e.lastIndexOf(" ",t);return-1===s?e.substring(0,t):e.substring(0,s)}s().useEffect((()=>{if(B)try{fetch("https://canvastodobackend.onrender.com/api/users/self/".concat(J)).then((e=>e.json())).then((e=>{t(e),fetch("https://canvastodobackend.onrender.com/api/users/".concat(e.id,"/enrollments/").concat(J)).then((e=>e.json())).then((e=>{o(e)}))})),fetch("https://canvastodobackend.onrender.com/api/courses/".concat(J)).then((e=>e.json())).then((e=>{let t=[];e=e.filter((e=>{if(!(e.name.split("(").splice(-1,1)[0].split("_")[0]+e.name.split("(").splice(-1,1)[0].split("_")[1]).includes("undefined"))return t.push(!1),e})),r(e),i(t);let s=[],n=[];for(const o of e)s.push(fetch("https://canvastodobackend.onrender.com/api/courses/".concat(o.id,"/modules/").concat(J)).then((e=>e.json()))),n.push(fetch("https://canvastodobackend.onrender.com/api/courses/".concat(o.id,"/assignments/").concat(J)).then((e=>e.json())));Promise.all(s).then((e=>{u(e);let t=[],s=[];e.forEach(((e,n)=>{if(Array.isArray(e)){let n=[],o=e.map((e=>{const[t,s,n]=e.items_url.match(/courses\/(\d+)\/modules\/(\d+)\/items/);return fetch("https://canvastodobackend.onrender.com/api/courses/".concat(s,"/modules/").concat(n,"/items/").concat(J)).then((e=>e.json()))}));for(let e=0;e<o.length;e++)n.push(!1);t.push(n),s.push(Promise.all(o))}else t.push(!1),s.push(!1)})),Promise.all(s).then((e=>{w(e),A(t)})).catch((e=>{console.log("Error fetching module items:",e)}))})).catch((e=>{console.log("Error fetching course modules:",e)})),Promise.all(n).then((e=>{g(e);let t=[];e.forEach((e=>{if(Array.isArray(e)){let s=[];e.forEach((e=>{const[t,n,o]=e.html_url.match(/courses\/(\d+)\/assignments\/(\d+)/);s.push(fetch("https://canvastodobackend.onrender.com/api/courses/".concat(n,"/assignments/").concat(o,"/submissions/self/").concat(J)).then((e=>e.json())))})),t.push(Promise.all(s))}else t.push(!1)})),Promise.all(t).then((t=>{k(t),function(e,t){let s=[];for(let n=0;n<e.length;n++)if(Array.isArray(e[n]))for(let o=0;o<e[n].length;o++)s.push([s.length,e[n][o],n,o,0,1,0,t[n][o]]);f(s),localStorage.setItem("unsortedToDo",JSON.stringify(s)),v((()=>{const e=s.concat(N);return e.sort(((e,t)=>new Date(e[1].due_at).getTime()-new Date(t[1].due_at).getTime())),e}))}(e,t)})).catch((e=>{console.log("Error fetching submissions:",e)}))})).catch((e=>{console.log("Error fetching assignments:",e)}))}))}catch(e){console.log(e)}}),[B]);const K=m.map(((e,t)=>(0,a.jsxs)("div",{className:"courseModal-item",children:[(0,a.jsx)("div",{style:{textTransform:"capitalize"},children:"".concat(e[0].split("(").splice(-1,1)[0].split("_")[0]+e[0].split("(").splice(-1,1)[0].split("_")[1]," -\n            ").concat(e[0].split(" (").splice(0,1)[0].toLowerCase())}),(0,a.jsx)("button",{className:"courseModal-item-btn",onClick:()=>{h((e=>{const s=[...e];return s.splice(t,1),localStorage.setItem("removedCourses",JSON.stringify(s)),s}))},children:"+"})]},t))),H=l?l.map(((e,t)=>{const s=e.name.split(" (").splice(0,1)[0].toLowerCase(),n=e.name.split("(").splice(-1,1)[0].split("_")[0]+e.name.split("(").splice(-1,1)[0].split("_")[1];return m.map((e=>e[0])).includes(e.name)?(0,a.jsx)("div",{},t):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"course",children:[P?(0,a.jsx)("div",{className:"course-name",children:s}):(0,a.jsx)("div",{}),(0,a.jsx)("div",{className:"course-crn",children:n}),(0,a.jsx)("div",{className:"course-delete",onClick:()=>{h((t=>{const s=[...t];return s.push([e.name,e]),localStorage.setItem("removedCourses",JSON.stringify(s)),s}))},children:"x"})]}),(0,a.jsx)("hr",{className:"horizontal-line",style:{border:"1px solid #eee",borderRadius:"5px",margin:"5px 0px"}})]},t)})):(0,a.jsx)("div",{children:"Courses Loading..."}),W=d&&d.length>0?d.map(((e,t)=>{const s=!!c&&c[t];return m.map((e=>e[0])).includes(l[t].name)?(0,a.jsx)("div",{},t):(0,a.jsxs)("div",{children:[0===t?(0,a.jsx)("hr",{}):"",(0,a.jsxs)("div",{className:"course-header",onClick:Array.isArray(e)?()=>function(e){if(c.length>0){const t=[...c];t[e]=!t[e],i(t)}}(t):void 0,children:[(0,a.jsx)("div",{className:"course-title",children:H[t].props.children[0].props.children[1].props.children}),(0,a.jsxs)("div",{className:"course-grade",children:["Grade: ",R(l[t].id)]}),(0,a.jsx)("span",{className:"course-arrow",children:Array.isArray(e)&&c?c[t]?"\u25b2":"\u25bc":""})]}),s?Array.isArray(e)?e.map(((e,s)=>{const n=!!I[t]&&(!!I[t][s]&&I[t][s]);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"module",onClick:()=>function(e,t){if(I.length>0){const s=[...I];s[e][t]=!s[e][t],A(s)}}(t,s),children:(0,a.jsxs)("div",{className:"module-header",children:[(0,a.jsx)("div",{className:"module-name",children:e.name}),(0,a.jsx)("span",{className:"module-arrow",children:n?"\u25b2":"\u25bc"})]})}),(0,a.jsx)("div",{className:"module-items",children:n&&C[t][s].length>0?C[t][s].map(((e,s)=>{const n=function(e,t){const s=p[e];for(let n=0;n<s.length;n++)if(s[n].name===t.title)return{assignment:s[n],index:n};return null}(t,e),o=n?q(n.assignment.due_at):null,[l,r]=o?U(o):[null,null],c=z(e.title,30),i=!!(n&&b[t]&&b[t][n.index]);return(0,a.jsxs)("div",{className:"module-item",children:[(0,a.jsx)("div",{style:{width:"220px"},children:c}),(0,a.jsxs)("div",{className:"module-item-attributes",style:{width:"75px"},children:[(0,a.jsx)("div",{style:{width:"55px",textAlign:"start"},children:i&&b[t][n.index].grade?"".concat(parseFloat(parseFloat(b[t][n.index].grade).toFixed(2)),"/").concat(n.assignment.points_possible):""}),(0,a.jsx)("div",{className:"".concat(r<=0?"past-due":""," ").concat(r>0?"due":""),children:i?"graded"===b[t][n.index].workflow_state?"\ud83d\udfe9":"submitted"===b[t][n.index].workflow_state?l?"".concat(l):"\ud83d\udfe8":"":""})]})]},s)})):(0,a.jsx)("div",{})})]},s)})):(0,a.jsx)("div",{children:"Course has no modules"}):(0,a.jsx)("div",{}),(0,a.jsx)("hr",{})]},t)})):(0,a.jsx)("div",{children:"Modules Loading..."}),G=x.length>0?x.map(((e,t)=>{const[s,n,o,r,c,i,d,u]=e,h=n?q(n.due_at):null,[p,g]=h?U(h):[null,null],x=n?z(n.name,20):n.name,j=m.map((e=>e[0]));return["graded","submitted"].includes(u.workflow_state)||0!=c||"userAdded"!==o&&j.includes(l[o].name)||!(g<T)?(0,a.jsx)("div",{},t):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"toDo-item",children:[(0,a.jsxs)("div",{className:"toDo-item-title",children:[(0,a.jsx)("label",{className:"checkbox",children:(0,a.jsx)("input",{type:"checkbox",onChange:()=>{D((e=>{let a=[[n,t,s,o,i],...e];return a.length>5&&a.pop(),localStorage.setItem("completedAssignments",JSON.stringify(a)),a})),v((e=>{1==i?f((e=>{const t=[...e];return t[s][4]=1,localStorage.setItem("unsortedToDo",JSON.stringify(t)),t})):y((e=>{const t=[...e];return t[s][4]=1,localStorage.setItem("addedToDo",JSON.stringify(t)),t}));const n=[...e];return n[t][4]=1,n}))}})}),(0,a.jsxs)("div",{children:[o&&H[o]?"".concat(H[o].props.children[0].props.children[1].props.children," - "):"",x]})]}),(0,a.jsx)("div",{className:"".concat(g<0?"past-due":""," ").concat(0==g||1==g?"due":""),children:p})]}),(0,a.jsxs)("div",{className:"toDo-item-slider",children:[(0,a.jsx)("input",{className:"toDo-item-slider-input",type:"range",min:"0",max:"10",value:d,onChange:e=>{v((n=>{1==i?f((t=>{const n=[...t];return n[s][6]=e.target.value,localStorage.setItem("unsortedToDo",JSON.stringify(n)),n})):y((t=>{const n=[...t];return n[s][6]=e.target.value,localStorage.setItem("addedToDo",JSON.stringify(n)),n}));const o=[...n];return o[t][6]=e.target.value,o}))},style:{background:(()=>{const e=(d-0)/10*100;return"linear-gradient(to right, #4CAF50 0%, #4CAF50 ".concat(e,"%, #d3d3d3 ").concat(e,"%, #d3d3d3 100%)")})()}}),(0,a.jsxs)("span",{className:"toDo-item-slider-span",style:{left:"calc(".concat((d-0)/10*100,"% - 10px)")},children:[(d-0)/10*100,"%"]})]})]},t)})):(0,a.jsx)("div",{children:"Assignments Loading..."}),Y=G.length>0?S.map(((e,t)=>{const[s,n,o,r,c]=e,i=s?q(s.due_at):null,[d,u]=i?U(i):[null,null],m=s.name.length>50?z(s.name,Math.round(window.screen.width/25)):s.name;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"toDo-item",children:[(0,a.jsxs)("div",{className:"toDo-item-title",children:[(0,a.jsxs)("label",{className:"checkbox",children:[(0,a.jsx)("input",{type:"checkbox",checked:!0,onChange:()=>{v((e=>{1==c?f((e=>{const t=[...e];return t[o][4]=0,localStorage.setItem("unsortedToDo",JSON.stringify(t)),t})):y((e=>{const t=[...e];return t[o][4]=0,localStorage.setItem("addedToDo",JSON.stringify(t)),t}));const t=[...e];return t[n][4]=0,t})),D((e=>{const s=[...e];return s.splice(t,1),localStorage.setItem("completedAssignments",JSON.stringify(s)),s}))}}),(0,a.jsx)("span",{})]}),(0,a.jsxs)("div",{className:"toDo-item-name",children:[r&&l[r]?"".concat(l[r].name.split("(").splice(-1,1)[0].split("_")[0]+l[r].name.split("(").splice(-1,1)[0].split("_")[1]," - "):"",m]})]}),(0,a.jsx)("div",{className:"toDo-item-dueDate",children:d})]}),t!==t.length-1?(0,a.jsx)("hr",{className:"horizontal-line"}):""]},t)})):(0,a.jsx)("div",{});return(0,a.jsx)("div",{className:"container",children:null==J?(0,a.jsx)("div",{className:"login-container",children:(0,a.jsxs)("div",{className:"login",children:[(0,a.jsx)("div",{className:"login-header",children:"Canvas ToDo"}),(0,a.jsx)("input",{id:"login-input",type:"text",placeholder:"Enter API token",autoComplete:"off"}),(0,a.jsx)("div",{id:"login-alert",children:"Invalid token"}),(0,a.jsx)("button",{className:"login-button",onClick:()=>{const e=document.getElementById("login-input").value;fetch("https://canvastodobackend.onrender.com/api/users/self/".concat(e)).then((e=>e.json())).then((t=>{if(0==e.length||t.errors)throw new Error;L(!0),localStorage.setItem("validKey",JSON.stringify(!0)),M(e),localStorage.setItem("key",JSON.stringify(e))})).catch((()=>{document.getElementById("login-alert").classList.add("show"),setTimeout((()=>{document.getElementById("login-alert").classList.remove("show")}),2e3)}))},children:"Login"}),(0,a.jsx)("div",{className:"tutorial",children:(0,a.jsx)("a",{id:"tutorial-text",href:"https://kb.iu.edu/d/aaja",target:"_blank",children:"Request an API token"})})]})}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{id:"courseModal",className:"modal",children:(0,a.jsxs)("div",{id:"courseModal-content",className:"modal-content",children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("div",{className:"modal-title",children:"Removed Courses"}),(0,a.jsx)("span",{className:"close",onClick:()=>{document.getElementById("courseModal").style.display="none",document.body.style.overflow="auto"},children:"\xd7"})]}),K]})}),(0,a.jsxs)("div",{className:"user",children:[(0,a.jsxs)("div",{className:"user-info",children:[(0,a.jsx)("div",{children:e.name}),(0,a.jsxs)("div",{children:["ID: ",e.id]})]}),(0,a.jsxs)("div",{className:"dropdown-container",children:[(0,a.jsx)("img",{className:"user-img",src:e.avatar_url?e.avatar_url:"/default_profile_pic.jpeg",alt:"User Avatar"}),(0,a.jsx)("div",{className:"dropdown-menu",children:(0,a.jsx)("ul",{children:(0,a.jsx)("li",{onClick:()=>{M(""),L(!1),localStorage.removeItem("key"),localStorage.removeItem("validKey"),window.location.reload()},children:"Logout"})})})]})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("div",{className:"section-title",style:{margin:"0px"},children:"Courses"}),(0,a.jsxs)("div",{className:"course-inputs",children:[(0,a.jsx)("button",{className:"button",onClick:()=>{document.getElementById("courseModal").style.display="block",document.body.style.overflow="hidden"},children:"Re-add Course"}),(0,a.jsxs)("div",{className:"course-inputs-checkbox",children:[(0,a.jsx)("input",{type:"checkbox",checked:P,onChange:()=>{F((e=>(e?(Array.from(document.getElementsByClassName("course-crn")).forEach((e=>{e.style.flex="0.6",e.style.textAlign="start"})),Array.from(document.getElementsByClassName("course")).forEach((e=>{e.style.justifyContent="space-evenly"}))):(Array.from(document.getElementsByClassName("course-crn")).forEach((e=>{e.style.flex="0.4",e.style.textAlign="center"})),Array.from(document.getElementsByClassName("course")).forEach((e=>{e.style.justifyContent="space-between"}))),!e)))}}),(0,a.jsx)("div",{children:"Full Name"})]})]}),(0,a.jsx)("div",{className:"course-container",children:H})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("div",{className:"toDo-title",children:"To-do"}),(0,a.jsxs)("div",{className:"toDo-add",children:[(0,a.jsxs)("div",{className:"toDo-add-container",children:[(0,a.jsx)("input",{id:"toDo-add-inputTask",placeholder:"Enter task",autoComplete:"off"}),(0,a.jsx)("input",{id:"toDo-add-inputDate",type:"date",value:_,onChange:e=>{E(e.target.value)}}),(0,a.jsx)("button",{className:"toDo-add-btn",onClick:()=>{const e=document.getElementById("toDo-add-inputTask"),t=e.value;y((e=>{const s=[...e],n={name:t,due_at:_};s.push([s.length,n,"userAdded","userAdded",0,2,0,{grade:"userAdded",workflow_state:"userAdded"}]),localStorage.setItem("addedToDo",JSON.stringify(s));const o=j.concat(s);return o.sort(((e,t)=>new Date(e[1].due_at).getTime()-new Date(t[1].due_at).getTime())),v(o),s})),e.value=""},children:"+"})]}),(0,a.jsxs)("select",{className:"toDo-select",value:T,onChange:e=>{O(e.target.value),localStorage.setItem("toDoExtent",e.target.value)},children:[(0,a.jsx)("option",{value:"7",children:"1 Week"}),(0,a.jsx)("option",{value:"14",children:"2 Weeks"}),(0,a.jsx)("option",{value:"30",children:"1 Month"}),(0,a.jsx)("option",{value:"1000",children:"Show All"})]})]}),x.length>0?(0,a.jsx)("div",{className:"toDo-header",children:"Current"}):(0,a.jsx)("div",{}),G,x.length>0?(0,a.jsx)("div",{className:"toDo-header second",children:"Completed"}):(0,a.jsx)("div",{}),Y]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("div",{className:"section-title",children:"Modules"}),W]})]})})};o().createRoot(document.getElementById("root")).render((0,a.jsx)(s().StrictMode,{children:(0,a.jsx)(l,{})}))})();
//# sourceMappingURL=main.8bfe20ad.js.map